<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>psy_view.plotmethods &mdash; psy-view  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/nc-table-styles.css?v=d585f46f" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=a4552690" />
      <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            psy-view
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#how-to-install">How to install</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-using-conda">Installation using conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-using-pip">Installation using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#installation-from-source">Installation from source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#required-dependencies">Required dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#running-the-tests">Running the tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#building-the-docs">Building the docs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installing.html#uninstallation">Uninstallation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#uninstallation-via-conda">Uninstallation via conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installing.html#uninstallation-via-pip">Uninstallation via pip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#binder-examples">Binder examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting-started.html#uploading-your-own-data">Uploading your own data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started.html#run-it-locally">Run it locally</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user-guide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user-guide.html#starting-the-gui">Starting the GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-guide.html#the-gui">The GUI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#resizing-the-gui-elements">Resizing the GUI elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#open-a-netcdf-file">Open a netCDF file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#view-the-dataset">View the dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#navigate-and-export">Navigate and export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#select-the-active-plot">Select the active plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#select-the-plot-method">Select the plot method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user-guide.html#mapplot">mapplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user-guide.html#plot2d">plot2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user-guide.html#lineplot">lineplot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#select-the-variables">Select the variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-guide.html#select-the-dimensions">Select the dimensions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user-guide.html#navigation-inside-the-plot">Navigation inside the plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-guide.html#using-psy-view-within-the-psyplot-gui">Using psy-view within the psyplot GUI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ncview.html">psy-view vs. ncview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line.html">Command line usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#positional-arguments">Positional Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../command_line.html#named-arguments">Named Arguments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/psy_view.html">psy_view package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/psy_view.html#psy_view.get_parser"><code class="docutils literal notranslate"><span class="pre">get_parser()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psy_view.html#psy_view.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psy_view.html#psy_view.start_app"><code class="docutils literal notranslate"><span class="pre">start_app()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/psy_view.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html"><code class="docutils literal notranslate"><span class="pre">BasemapDialog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.CmapDialog"><code class="docutils literal notranslate"><span class="pre">CmapDialog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.Color"><code class="docutils literal notranslate"><span class="pre">Color</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.ColorbarPreview"><code class="docutils literal notranslate"><span class="pre">ColorbarPreview</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.FakePlotter"><code class="docutils literal notranslate"><span class="pre">FakePlotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.FormatoptionsEditor"><code class="docutils literal notranslate"><span class="pre">FormatoptionsEditor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.LSM_T"><code class="docutils literal notranslate"><span class="pre">LSM_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.LabelDialog"><code class="docutils literal notranslate"><span class="pre">LabelDialog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.dialogs.html#psy_view.dialogs.LabelWidgetLine"><code class="docutils literal notranslate"><span class="pre">LabelWidgetLine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.ds_widget.html"><code class="docutils literal notranslate"><span class="pre">DatasetWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.ds_widget.html#psy_view.ds_widget.DatasetWidgetPlugin"><code class="docutils literal notranslate"><span class="pre">DatasetWidgetPlugin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.ds_widget.html#psy_view.ds_widget.DatasetWidgetStandAlone"><code class="docutils literal notranslate"><span class="pre">DatasetWidgetStandAlone</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.ds_widget.html#psy_view.ds_widget.get_dims_to_iterate"><code class="docutils literal notranslate"><span class="pre">get_dims_to_iterate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html"><code class="docutils literal notranslate"><span class="pre">GridCell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget"><code class="docutils literal notranslate"><span class="pre">LinePlotWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget"><code class="docutils literal notranslate"><span class="pre">MapPlotWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget"><code class="docutils literal notranslate"><span class="pre">Plot2DWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget"><code class="docutils literal notranslate"><span class="pre">PlotMethodWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotType"><code class="docutils literal notranslate"><span class="pre">PlotType</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.QHLine"><code class="docutils literal notranslate"><span class="pre">QHLine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.projection_map"><code class="docutils literal notranslate"><span class="pre">projection_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.rcsetup.html"><code class="docutils literal notranslate"><span class="pre">PsyViewRcParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.utils.html"><code class="docutils literal notranslate"><span class="pre">QRightPushButton</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.utils.html#psy_view.utils.add_pushbutton"><code class="docutils literal notranslate"><span class="pre">add_pushbutton()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/psy_view.utils.html#psy_view.utils.get_icon"><code class="docutils literal notranslate"><span class="pre">get_icon()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contribution and development hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../todo.html">ToDos</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">psy-view</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../psy_view.html">psy_view</a></li>
      <li class="breadcrumb-item active">psy_view.plotmethods</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for psy_view.plotmethods</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Plotmethod widgets.</span>

<span class="sd">This module defines the widgets to interface with the mapplot, plot2d and</span>
<span class="sd">lineplot plotmethods.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># SPDX-FileCopyrightText: 2020-2021 Helmholtz-Zentrum Geesthacht</span>
<span class="c1"># SPDX-FileCopyrightText: 2021-2024 Helmholtz-Zentrum hereon GmbH</span>
<span class="c1">#</span>
<span class="c1"># SPDX-License-Identifier: LGPL-3.0-only</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span> <span class="n">cycle</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TYPE_CHECKING</span><span class="p">,</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">ClassVar</span><span class="p">,</span>
    <span class="n">Dict</span><span class="p">,</span>
    <span class="n">Hashable</span><span class="p">,</span>
    <span class="n">Iterator</span><span class="p">,</span>
    <span class="n">List</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">Tuple</span><span class="p">,</span>
    <span class="n">Type</span><span class="p">,</span>
    <span class="n">TypeVar</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcol</span>
<span class="kn">import</span> <span class="nn">psy_simple.widgets.colors</span> <span class="k">as</span> <span class="nn">pswc</span>
<span class="kn">import</span> <span class="nn">psyplot.data</span> <span class="k">as</span> <span class="nn">psyd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">psyplot.utils</span> <span class="kn">import</span> <span class="n">unique_everseen</span>
<span class="kn">from</span> <span class="nn">psyplot_gui.common</span> <span class="kn">import</span> <span class="n">get_icon</span> <span class="k">as</span> <span class="n">get_psy_icon</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>

<span class="kn">import</span> <span class="nn">psy_view.dialogs</span> <span class="k">as</span> <span class="nn">dialogs</span>
<span class="kn">import</span> <span class="nn">psy_view.utils</span> <span class="k">as</span> <span class="nn">utils</span>
<span class="kn">from</span> <span class="nn">psy_view.rcsetup</span> <span class="kn">import</span> <span class="n">rcParams</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">psyplot.data</span> <span class="kn">import</span> <span class="n">InteractiveList</span>
    <span class="kn">from</span> <span class="nn">psyplot.plotter</span> <span class="kn">import</span> <span class="n">Plotter</span>
    <span class="kn">from</span> <span class="nn">psyplot.project</span> <span class="kn">import</span> <span class="n">Project</span>
    <span class="kn">from</span> <span class="nn">xarray</span> <span class="kn">import</span> <span class="n">DataArray</span><span class="p">,</span> <span class="n">Dataset</span>


<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;GridCell&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="PlotType">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotType">[docs]</a>
<span class="k">class</span> <span class="nc">PlotType</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A value for the 2D ``plot`` formatoption.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    psy_simple.plotters.Simple2DPlotter.plot</span>
<span class="sd">    psy_maps.plotters.FieldPlotter.plot</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mesh</span> <span class="o">=</span> <span class="s2">&quot;mesh&quot;</span>
    <span class="n">contourf</span> <span class="o">=</span> <span class="s2">&quot;contourf&quot;</span>
    <span class="n">contour</span> <span class="o">=</span> <span class="s2">&quot;contour&quot;</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="s2">&quot;poly&quot;</span></div>



<span class="c1">#: A mapping from projection identifier to the text we want to use in the GUI</span>
<span class="n">projection_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cf&quot;</span><span class="p">:</span> <span class="s2">&quot;Default&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cyl&quot;</span><span class="p">:</span> <span class="s2">&quot;Cylindric&quot;</span><span class="p">,</span>
    <span class="s2">&quot;robin&quot;</span><span class="p">:</span> <span class="s2">&quot;Robinson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ortho&quot;</span><span class="p">:</span> <span class="s2">&quot;Orthographic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;moll&quot;</span><span class="p">:</span> <span class="s2">&quot;Mollweide&quot;</span><span class="p">,</span>
    <span class="s2">&quot;northpole&quot;</span><span class="p">:</span> <span class="s2">&quot;Arctic (Northpole)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;southpole&quot;</span><span class="p">:</span> <span class="s2">&quot;Antarctic (Southpole)&quot;</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="GridCell">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.GridCell">[docs]</a>
<span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">GridCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A grid cell within a QGridLayout managing one QWidget.&quot;&quot;&quot;</span>

    <span class="c1">#: the :class:`PyQt5.QtWidgets.QWidget` instance (i.e. the widget) or a</span>
    <span class="c1">#: layout (:class:`PyQt5.QtWidgets.QLayout`)</span>
    <span class="n">qobject</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLayout</span><span class="p">]</span>

    <span class="c1">#: The starting column for the widget. If None, it will be estimated based</span>
    <span class="c1">#: on the other widgets in the row</span>
    <span class="n">column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#: The number of columns to cover</span>
    <span class="n">colspan</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1">#: A boolean whether to add stretch or not</span>
    <span class="n">stretch</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="GridCell.from_alias">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.GridCell.from_alias">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_alias</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T</span><span class="p">],</span>
        <span class="n">o</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLayout</span><span class="p">],</span>
        <span class="n">c</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">s</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a :class:`GridCell` from shorter kws.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        o: QWidget or QLayout</span>
<span class="sd">            The alias for :attr:`qobject`</span>
<span class="sd">        c: int or None, optional</span>
<span class="sd">            The alias for :attr:`column`</span>
<span class="sd">        cs: int, optional</span>
<span class="sd">            The alias for :attr:`colspan`</span>
<span class="sd">        s: bool, optional</span>
<span class="sd">            The alias for :attr:`stretch`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GridCell</span>
<span class="sd">            The generated instance of :class:`GridCell`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">qobject</span><span class="o">=</span><span class="n">o</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="n">cs</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">s</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PlotMethodWidget">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget">[docs]</a>
<span class="k">class</span> <span class="nc">PlotMethodWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for interfacing a psyplot plotmethod.</span>

<span class="sd">    This method serves as a base class for interfacing any of the psyplot</span>
<span class="sd">    plot methods registered via :func:`psyplot.project.register_plotter`.</span>

<span class="sd">    The name of the plotmethod should be implemented as the :attr:`plotmethod`</span>
<span class="sd">    attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">plotmethod</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1">#: trigger a replot of this widget. This can be emitted with the</span>
    <span class="c1">#: :meth:`trigger_replot` method</span>
    <span class="n">replot</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1">#: trigger a replot of this widget. This can be emitted with the</span>
    <span class="c1">#: :meth:`trigger_reset` method</span>
    <span class="n">reset</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1">#: signalize that the widget has been changed but not plot changes are</span>
    <span class="c1">#: needed</span>
    <span class="n">changed</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="n">array_info</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">layout</span><span class="p">:</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">get_sp</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Project</span><span class="p">]],</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_sp</span> <span class="o">=</span> <span class="n">get_sp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;layout&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

<div class="viewcode-block" id="PlotMethodWidget.setup">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.setup">[docs]</a>
    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the widget during initialization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_widgets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_widget_grid</span><span class="p">()</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formatoption_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">GridCell</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a mapping from row name to a row of :class:`GridCells`.&quot;&quot;&quot;</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">GridCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt_setup_functions</span><span class="p">:</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rows</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">rows</span>

<div class="viewcode-block" id="PlotMethodWidget.get_rows">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.get_rows">[docs]</a>
    <span class="k">def</span> <span class="nf">get_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">GridCell</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the rows of the formatoption widgets.</span>

<span class="sd">        This method should take callable from the :attr:`fmt_setup_functions`</span>
<span class="sd">        list and return the rows corresponding to :attr:`formatoption_rows`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[[]]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fmt_setup_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of rows for formatoptions.</span>

<span class="sd">        This property returns a list of callable. Each callable should setup</span>
<span class="sd">        a horizonal (or widget) that is added to the :attr:`layout` vbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span>

<div class="viewcode-block" id="PlotMethodWidget.setup_widgets">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.setup_widgets">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the widgets for this plotmethod.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt_setup_functions</span><span class="p">:</span>
            <span class="n">func</span><span class="p">()</span></div>


<div class="viewcode-block" id="PlotMethodWidget.setup_separation_line">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.setup_separation_line">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_separation_line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Just a convenience function to create a separation line.</span>

<span class="sd">        This method does nothing but tells :meth:`get_rows` to add an instance</span>
<span class="sd">        of :class:`QHline`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="PlotMethodWidget.setup_widget_grid">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.setup_widget_grid">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_widget_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the widget grid based on :attr:`formatoption_rows`.&quot;&quot;&quot;</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatoption_rows</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">col</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">gc</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">gc</span><span class="o">.</span><span class="n">column</span> <span class="k">if</span> <span class="n">gc</span><span class="o">.</span><span class="n">column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">col</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">qobject</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLayout</span><span class="p">):</span>
                    <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">qobject</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gc</span><span class="o">.</span><span class="n">colspan</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">gc</span><span class="o">.</span><span class="n">qobject</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gc</span><span class="o">.</span><span class="n">colspan</span><span class="p">)</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="n">gc</span><span class="o">.</span><span class="n">colspan</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setRowStretch</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Project</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the subproject of this plotmethod interface.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_sp</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataArray</span><span class="p">,</span> <span class="n">InteractiveList</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the data of this plotmethod interface.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No plot has yet been initialized&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">plotter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Plotter</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the first plotter of the :attr:`sp` project.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">plotters</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">plotters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formatoptions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoption keys of this plotmethod.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">psyplot.project</span> <span class="k">as</span> <span class="nn">psy</span>

            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span><span class="o">.</span><span class="n">plotter_cls</span><span class="p">())</span>

<div class="viewcode-block" id="PlotMethodWidget.get_fmts">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.get_fmts">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fmts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">DataArray</span><span class="p">,</span> <span class="n">init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoptions for a new plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var: xarray.Variable</span>
<span class="sd">            The variable in the base dataset</span>
<span class="sd">        init: bool</span>
<span class="sd">            If True, call the :meth:`init_dims` method to inject necessary</span>
<span class="sd">            formatoptions and dimensions for the initialization.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from formatoption or dimension to the corresponding value</span>
<span class="sd">            for the plotmethod.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">init</span><span class="p">:</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_dims</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="PlotMethodWidget.init_dims">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.init_dims">[docs]</a>
    <span class="k">def</span> <span class="nf">init_dims</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">DataArray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoptions for a new plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var: xarray.Variable</span>
<span class="sd">            The variable in the base dataset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from formatoption or dimension to the corresponding value</span>
<span class="sd">            for the plotmethod.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{}</span></div>


<div class="viewcode-block" id="PlotMethodWidget.refresh">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.refresh">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh this widget from the given dataset.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">))</span></div>


<div class="viewcode-block" id="PlotMethodWidget.trigger_replot">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.trigger_replot">[docs]</a>
    <span class="k">def</span> <span class="nf">trigger_replot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emit the :attr:`replot` signal to replot the project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replot</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotMethodWidget.trigger_reset">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.trigger_reset">[docs]</a>
    <span class="k">def</span> <span class="nf">trigger_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emit the :attr:`reset` signal to reinitialize the project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">array_info</span><span class="p">(</span><span class="n">standardize_dims</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotMethodWidget.trigger_refresh">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.trigger_refresh">[docs]</a>
    <span class="k">def</span> <span class="nf">trigger_refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emit the :attr:`changed` signal to notify changes in the plot.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotMethodWidget.get_slice">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.get_slice">[docs]</a>
    <span class="k">def</span> <span class="nf">get_slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the slice for the selected coordinates.</span>

<span class="sd">        This method is called when the user clicks on the coordinates in the</span>
<span class="sd">        plot.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        psy_view.ds_widget.DatasetWidget.display_line</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is reimplemented in the :class:`MapPlotWidget`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="PlotMethodWidget.valid_variables">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.PlotMethodWidget.valid_variables">[docs]</a>
    <span class="k">def</span> <span class="nf">valid_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Hashable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of variables that can be visualized with this plotmethod.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds: xarray.Dataset</span>
<span class="sd">            The dataset to use</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of str</span>
<span class="sd">            List of variable names to plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plotmethod</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">plot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="n">init_kws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_dims</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="n">init_kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dims&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">decoder</span> <span class="o">=</span> <span class="n">init_kws</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;decoder&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plotmethod</span><span class="o">.</span><span class="n">check_data</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">decoder</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>
</div>



<div class="viewcode-block" id="QHLine">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.QHLine">[docs]</a>
<span class="k">class</span> <span class="nc">QHLine</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A horizontal seperation line.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">HLine</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="MapPlotWidget">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget">[docs]</a>
<span class="k">class</span> <span class="nc">MapPlotWidget</span><span class="p">(</span><span class="n">PlotMethodWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget to control the mapplot plotmethod.&quot;&quot;&quot;</span>

    <span class="n">plotmethod</span> <span class="o">=</span> <span class="s2">&quot;mapplot&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Project</span><span class="p">]:</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sp</span>
        <span class="k">if</span> <span class="n">sp</span><span class="p">:</span>
            <span class="n">arrays</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">arr_name</span>
                <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">sp</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">psyd</span><span class="o">.</span><span class="n">InteractiveList</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="n">sp</span><span class="p">(</span><span class="n">arr_name</span><span class="o">=</span><span class="n">arrays</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sp</span>

<div class="viewcode-block" id="MapPlotWidget.get_rows">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.get_rows">[docs]</a>
    <span class="k">def</span> <span class="nf">get_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">GridCell</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the rows of the formatoption widgets.</span>

<span class="sd">        This method should take callable from the :attr:`fmt_setup_functions`</span>
<span class="sd">        list and return the rows corresponding to :attr:`formatoption_rows`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_color_buttons</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Colormap&quot;</span><span class="p">)),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="p">),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap_settings</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_plot_buttons</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Plot type&quot;</span><span class="p">)),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span><span class="p">),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_projection_buttons</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Projection&quot;</span><span class="p">)),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="p">),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_proj_settings</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_labels_button</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_separation_line</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">GridCell</span><span class="p">(</span><span class="n">QHLine</span><span class="p">(),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_dimension_box</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown function </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">row</span><span class="p">]</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fmt_setup_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of rows for formatoptions.</span>

<span class="sd">        This property returns a list of callable. Each callable should setup</span>
<span class="sd">        a horizonal (or widget) that is added to the :attr:`layout` vbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_color_buttons</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_plot_buttons</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_projection_buttons</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_labels_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_separation_line</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_dimension_box</span><span class="p">,</span>
        <span class="p">]</span>

<div class="viewcode-block" id="MapPlotWidget.setup_labels_button">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_labels_button">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_labels_button</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a button to modify the text labels.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="s2">&quot;Edit labels&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_labels</span><span class="p">,</span>
            <span class="s2">&quot;Edit title, colorbar labels, etc.&quot;</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_plot_buttons">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_plot_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_plot_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the second row of formatoption widgets.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">PlotType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">PlotType</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span>
            <span class="n">PlotType</span><span class="o">.</span><span class="n">contourf</span><span class="p">,</span>
            <span class="n">PlotType</span><span class="o">.</span><span class="n">contour</span><span class="p">,</span>
            <span class="n">PlotType</span><span class="o">.</span><span class="n">poly</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Default&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Filled contours&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Contours&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Gridcell polygons&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Disable&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_set_plot_type</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="s2">&quot;Gridcell boundaries&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggle_datagrid</span><span class="p">,</span>
            <span class="s2">&quot;Toggle the visibility of grid cell boundaries&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_color_buttons">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_color_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_color_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the buttons to change the colormap, etc.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span> <span class="o">=</span> <span class="n">pswc</span><span class="o">.</span><span class="n">CmapButton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Select a different colormap&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">colormap_changed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">colormap_changed</span><span class="p">[</span><span class="n">mcol</span><span class="o">.</span><span class="n">Colormap</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_cmap_menu</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap_settings</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">get_icon</span><span class="p">(</span><span class="s2">&quot;color_settings&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_color_settings</span><span class="p">,</span>
            <span class="s2">&quot;Edit color settings&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_cmap_menu">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_cmap_menu">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_cmap_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the menu to change the colormaps.&quot;&quot;&quot;</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">cmap_menu</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_cmap_action</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
            <span class="s2">&quot;More colormaps&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_cmap_dialog</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">color_settings_action</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_icon</span><span class="p">(</span><span class="s2">&quot;color_settings&quot;</span><span class="p">)),</span>
            <span class="s2">&quot;More options&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_color_settings</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">menu</span></div>


<div class="viewcode-block" id="MapPlotWidget.open_cmap_dialog">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.open_cmap_dialog">[docs]</a>
    <span class="k">def</span> <span class="nf">open_cmap_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the dialog to change the colormap.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        N: int</span>
<span class="sd">            The number of colormaps to show</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        psy_simple.widgets.colors.CmapButton</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
            <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">mappable</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">()</span><span class="o">.</span><span class="n">N</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">open_cmap_dialog</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_projection_menu">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_projection_menu">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_projection_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the menu to modify the basemap.&quot;&quot;&quot;</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">projection</span> <span class="ow">in</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;projections&quot;</span><span class="p">]:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
                <span class="n">projection_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="n">projection</span><span class="p">),</span>
                <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_projection</span><span class="p">,</span> <span class="n">projection</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_settings_action</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_icon</span><span class="p">(</span><span class="s2">&quot;proj_settings&quot;</span><span class="p">)),</span>
            <span class="s2">&quot;Customize basemap...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_basemap_settings</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">menu</span></div>


<div class="viewcode-block" id="MapPlotWidget.get_projection_label">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.get_projection_label">[docs]</a>
    <span class="k">def</span> <span class="nf">get_projection_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the label for a projection in the GUI.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        proj: str</span>
<span class="sd">            The projection value for the</span>
<span class="sd">            :attr:`~psy_maps.plotters.FieldPlotter.plot` formatoption</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The label of the projection in the GUI</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_projection_label</span>
<span class="sd">        projection_map</span>
<span class="sd">        psy_maps.plotters.FieldPlotter.plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">projection_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.get_projection_value">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.get_projection_value">[docs]</a>
    <span class="k">def</span> <span class="nf">get_projection_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value for the `projection` formatoption.</span>

<span class="sd">        This method is the inverse of :meth:`get_projection_label`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        label: str</span>
<span class="sd">            The projection label that is used in the GUI</span>
<span class="sd">            :attr:`~psy_maps.plotters.FieldPlotter.plot` formatoption</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The value to use for the ``projection`` formatoption</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_projection_label</span>
<span class="sd">        projection_map</span>
<span class="sd">        psy_maps.plotters.FieldPlotter.plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inv_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">lbl</span><span class="p">:</span> <span class="n">proj</span> <span class="k">for</span> <span class="n">proj</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">projection_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="n">inv_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;projections&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_projection_buttons">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_projection_buttons">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_projection_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the buttons to modify the basemap.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_projection_label</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;projections&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">choose_next_projection</span><span class="p">,</span>
            <span class="s2">&quot;Change the basemap projection&quot;</span><span class="p">,</span>
            <span class="n">toolbutton</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_projection_menu</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setPopupMode</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolButton</span><span class="o">.</span><span class="n">MenuButtonPopup</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj_settings</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="n">utils</span><span class="o">.</span><span class="n">get_icon</span><span class="p">(</span><span class="s2">&quot;proj_settings&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_basemap_settings</span><span class="p">,</span>
            <span class="s2">&quot;Edit basemap settings&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.setup_dimension_box">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setup_dimension_box">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_dimension_box</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up a box to control, what is the x and y-dimension.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;x-Dimension:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;y-Dimension:&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;x-Coordinate:&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;y-Coordinate:&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimension_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_xcoord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_ycoord</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trigger_refresh</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.set_xcoord">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_xcoord">[docs]</a>
    <span class="k">def</span> <span class="nf">set_xcoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the name of the x-coordinate.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_combo_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.set_ycoord">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_ycoord">[docs]</a>
    <span class="k">def</span> <span class="nf">set_ycoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the name of the y-coordinate.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_combo_text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.set_combo_text">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_combo_text">[docs]</a>
    <span class="k">def</span> <span class="nf">set_combo_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo</span><span class="p">:</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convenience function to update set the current text of a combobox.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        combo: PyQt5.QtWidgets.QComboBox</span>
<span class="sd">            The combobox to modify</span>
<span class="sd">        text: str</span>
<span class="sd">            The item to use&quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">itemText</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">count</span><span class="p">())))</span>
        <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">text</span><span class="p">))</span></div>


<div class="viewcode-block" id="MapPlotWidget.init_dims">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.init_dims">[docs]</a>
    <span class="k">def</span> <span class="nf">init_dims</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">DataArray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoptions for a new plot.</span>

<span class="sd">        This method updates the coordinates combo boxes with the</span>
<span class="sd">        x- and y-coordinate of the variable.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var: xarray.Variable</span>
<span class="sd">            The variable in the base dataset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from formatoption or dimension to the corresponding value</span>
<span class="sd">            for the plotmethod.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init_dims</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

        <span class="n">dims</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">xdim</span> <span class="o">=</span> <span class="n">ydim</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">xdim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">xdim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">dims</span><span class="p">[</span><span class="n">xdim</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">ydim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ydim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">dims</span><span class="p">[</span><span class="n">ydim</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dims</span><span class="p">:</span>
            <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="n">dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">:</span>
                <span class="n">dims</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">xdim</span> <span class="o">!=</span> <span class="n">ydim</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">xdim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">xdim</span> <span class="o">=</span> <span class="n">missing</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ydim</span> <span class="o">=</span> <span class="n">missing</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">dims</span><span class="p">[</span><span class="n">missing</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># keep the last dimension</span>
            <span class="n">ret</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dims</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">xcoord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">ret</span><span class="p">[</span><span class="s2">&quot;decoder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">xcoord</span><span class="p">}}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">ycoord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;decoder&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">ret</span><span class="p">[</span><span class="s2">&quot;decoder&quot;</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">ycoord</span><span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">xdim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">xdim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span>
            <span class="ow">and</span> <span class="n">ydim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">ydim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span>
        <span class="p">):</span>
            <span class="n">ret</span><span class="p">[</span><span class="s2">&quot;transpose&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">xdim</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ydim</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="MapPlotWidget.valid_variables">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.valid_variables">[docs]</a>
    <span class="k">def</span> <span class="nf">valid_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Hashable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of variables that can be visualized with this plotmethod.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds: xarray.Dataset</span>
<span class="sd">            The dataset to use</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of str</span>
<span class="sd">            List of variable names to plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">valid_variables</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">valid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">xdim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="n">xdim</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">ydim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="n">ydim</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">xc_dims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">currentText</span><span class="p">()]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="n">xc_dims</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="n">yc_dims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">currentText</span><span class="p">()]</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
            <span class="n">valid</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="n">yc_dims</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">valid</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coord_combos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the combo boxes for x- and y-dimension and -coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="p">,</span>
        <span class="p">]</span>

<div class="viewcode-block" id="MapPlotWidget.block_combos">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.block_combos">[docs]</a>
    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span> <span class="nf">block_combos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Temporarilly block any signal of the :attr:`coord_combos`.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">yield</span>
        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.setEnabled">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.setEnabled">[docs]</a>
    <span class="k">def</span> <span class="nf">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable the projection and color buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b: bool</span>
<span class="sd">            If True, enable the buttons, else disable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj_settings</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_settings_action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_settings_action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap_settings</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.set_cmap">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_cmap">[docs]</a>
    <span class="k">def</span> <span class="nf">set_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the plotter with the given colormap.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cmap: str</span>
<span class="sd">            The colormap name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">and</span> <span class="s2">&quot;cmap&quot;</span> <span class="ow">in</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.toggle_datagrid">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.toggle_datagrid">[docs]</a>
    <span class="k">def</span> <span class="nf">toggle_datagrid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Toggle the visibility of the grid cell boundaries.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datagrid</span><span class="o">=</span><span class="s2">&quot;k-&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">datagrid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.edit_labels">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.edit_labels">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the dialog to edit the text labels in the plot.&quot;&quot;&quot;</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">LabelDialog</span><span class="o">.</span><span class="n">update_project</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;figtitle&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;clabel&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.edit_color_settings">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.edit_color_settings">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_color_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the dialog to edit the color settings.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">CmapDialog</span><span class="o">.</span><span class="n">update_project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Custom&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.choose_next_projection">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.choose_next_projection">[docs]</a>
    <span class="k">def</span> <span class="nf">choose_next_projection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Choose the next projection from the rcParams `projection` value.&quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">nprojections</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;projections&quot;</span><span class="p">])</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_projection_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">proj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cycle</span><span class="p">(</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;projections&quot;</span><span class="p">])):</span>
            <span class="k">if</span> <span class="n">proj</span> <span class="o">==</span> <span class="n">current</span><span class="p">:</span>
                <span class="n">select</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">select</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nprojections</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_projection</span><span class="p">(</span><span class="n">proj</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.set_projection">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_projection">[docs]</a>
    <span class="k">def</span> <span class="nf">set_projection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the projection of the plot with the given projection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        projection: str</span>
<span class="sd">            The projection name for the</span>
<span class="sd">            :attr:`~psy_maps.plotters.FieldPlotter.projection` formatoption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_projection_label</span><span class="p">(</span><span class="n">proj</span><span class="p">))</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="n">plotter</span> <span class="ow">and</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_set_plot_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the plot type from the index in :attr:`combo_plot`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_plot_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<div class="viewcode-block" id="MapPlotWidget.set_plot_type">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.set_plot_type">[docs]</a>
    <span class="k">def</span> <span class="nf">set_plot_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlotType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the value for the ``plot`` formatoption</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ploy_type: :class:`PlotType` or None</span>
<span class="sd">            The value for the :attr:`~psy_simple.plotters.Simple2DPlotter.plot`</span>
<span class="sd">            formatoption.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="n">plotter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.edit_basemap_settings">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.edit_basemap_settings">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_basemap_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open a dialog to edit the basemap and projection settings.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">:</span>
            <span class="n">dialogs</span><span class="o">.</span><span class="n">BasemapDialog</span><span class="o">.</span><span class="n">update_plotter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotter</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.get_fmts">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.get_fmts">[docs]</a>
    <span class="k">def</span> <span class="nf">get_fmts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">DataArray</span><span class="p">,</span> <span class="n">init</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoptions for a new plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var: xarray.Variable</span>
<span class="sd">            The variable in the base dataset</span>
<span class="sd">        init: bool</span>
<span class="sd">            If True, call the :meth:`init_dims` method to inject necessary</span>
<span class="sd">            formatoptions and dimensions for the initialization.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from formatoption or dimension to the corresponding value</span>
<span class="sd">            for the plotmethod.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fmts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formatoptions</span><span class="p">:</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;projection&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_projection_value</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;time&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(time)s</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;long_name&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;clabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(long_name)s</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;clabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%(name)s</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;units&quot;</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;clabel&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">%(units)s</span><span class="s2">&quot;</span>

        <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;plot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_plot</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()]</span>
        <span class="k">if</span> <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;plot&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;contour&quot;</span><span class="p">:</span>
            <span class="c1"># we need to set a global map extend, see</span>
            <span class="c1"># https://github.com/SciTools/cartopy/issues/1673</span>
            <span class="n">fmts</span><span class="p">[</span><span class="s2">&quot;map_extent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>

        <span class="k">if</span> <span class="n">init</span><span class="p">:</span>
            <span class="n">fmts</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_dims</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">fmts</span></div>


<div class="viewcode-block" id="MapPlotWidget.refresh">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.refresh">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh this widget from the given dataset.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">))</span>

        <span class="n">auto</span> <span class="o">=</span> <span class="s2">&quot;Set automatically&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_from_sp</span><span class="p">()</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_combos</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>

            <span class="n">current_dims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">itemText</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">ds_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">(</span><span class="n">dim</span> <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">current_dims</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds_dims</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">auto</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds_dims</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">auto</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds_dims</span><span class="p">)</span>

            <span class="n">current_coords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">itemText</span><span class="p">,</span>
                    <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">count</span><span class="p">()),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">ds_coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">current_coords</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds_coords</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">auto</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds_coords</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="n">auto</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds_coords</span><span class="p">)</span>

            <span class="n">enable_combos</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">enable_combos</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_combos</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span>
                <span class="p">]</span>
            <span class="k">elif</span> <span class="n">enable_combos</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">reset</span><span class="p">,</span> <span class="n">combo</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_combos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">reset</span><span class="p">:</span>
                        <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_combos</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_combos</span><span class="p">:</span>
                <span class="n">combo</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enable_combos</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">enable_combos</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
                <span class="n">xdim</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">get_dim</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
                <span class="n">ydim</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">get_dim</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xdim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">xdim</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ydim</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">ydim</span><span class="p">)</span>
                <span class="n">xcoord</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">get_coord</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
                <span class="n">xcoord</span> <span class="o">=</span> <span class="n">xcoord</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">xcoord</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">xdim</span>
                <span class="n">ycoord</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">get_coord</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
                <span class="n">ycoord</span> <span class="o">=</span> <span class="n">ycoord</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">ycoord</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ydim</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">combo_xcoord</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">xcoord</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_ycoord</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">ycoord</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.refresh_from_sp">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.refresh_from_sp">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_from_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh this widget from the plotters project.&quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">projection</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_projection_label</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">projection</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_proj</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Custom&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Custom&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MapPlotWidget.transform">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.transform">[docs]</a>
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform coordinates of a point to the plots projection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x: float</span>
<span class="sd">            The x-coordinate in axes coordinates</span>
<span class="sd">        y: float</span>
<span class="sd">            The y-coordinate in axes coordinates</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The transformed x-coordinate `x`</span>
<span class="sd">        float</span>
<span class="sd">            The transformed y-coordinate `y`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot transform the coordinates as no plot is shown &quot;</span>
                <span class="s2">&quot;currently!&quot;</span>
            <span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">projection</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">plotter</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span>
        <span class="p">)</span>
        <span class="c1"># shift if necessary</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">projection</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">):</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">xcoord</span>
            <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">-=</span> <span class="mi">360</span>
            <span class="k">elif</span> <span class="n">coord</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">180</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">-=</span> <span class="mi">360</span>
            <span class="k">if</span> <span class="s2">&quot;rad&quot;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;units&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>


<div class="viewcode-block" id="MapPlotWidget.get_slice">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.MapPlotWidget.get_slice">[docs]</a>
    <span class="k">def</span> <span class="nf">get_slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the slice for the selected coordinates.</span>

<span class="sd">        This method is called when the user clicks on the coordinates in the</span>
<span class="sd">        plot.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        psy_view.ds_widget.DatasetWidget.display_line</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is reimplemented in the :class:`MapPlotWidget`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">psy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot transform the coordinates as no plot is shown &quot;</span>
                <span class="s2">&quot;currently!&quot;</span>
            <span class="p">)</span>

        <span class="n">fmto</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot</span>

        <span class="n">xcoord</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">xcoord</span>
        <span class="n">ycoord</span> <span class="o">=</span> <span class="n">fmto</span><span class="o">.</span><span class="n">ycoord</span>
        <span class="k">if</span> <span class="n">fmto</span><span class="o">.</span><span class="n">decoder</span><span class="o">.</span><span class="n">is_unstructured</span><span class="p">(</span><span class="n">fmto</span><span class="o">.</span><span class="n">raw_data</span><span class="p">)</span> <span class="ow">or</span> <span class="n">xcoord</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="n">xcoord</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">ycoord</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">imin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xcoord</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="p">[</span><span class="n">imin</span> <span class="o">//</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">imin</span> <span class="o">%</span> <span class="n">ncols</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">imin</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ix</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">xcoord</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">xcoord</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
            <span class="n">iy</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ycoord</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="n">ycoord</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="p">[</span><span class="n">iy</span><span class="p">,</span> <span class="n">ix</span><span class="p">]))</span></div>
</div>



<div class="viewcode-block" id="Plot2DWidget">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget">[docs]</a>
<span class="k">class</span> <span class="nc">Plot2DWidget</span><span class="p">(</span><span class="n">MapPlotWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget to control the plot2d plotmethod.&quot;&quot;&quot;</span>

    <span class="n">plotmethod</span> <span class="o">=</span> <span class="s2">&quot;plot2d&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fmt_setup_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of rows for formatoptions.</span>

<span class="sd">        This property returns a list of callable. Each callable should setup</span>
<span class="sd">        a horizonal (or widget) that is added to the :attr:`layout` vbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fmt_setup_functions</span>
        <span class="n">ret</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_projection_buttons</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Plot2DWidget.setEnabled">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget.setEnabled">[docs]</a>
    <span class="k">def</span> <span class="nf">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable the datagrid and color buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b: bool</span>
<span class="sd">            If True, enable the buttons, else disable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_datagrid</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap_settings</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plot2DWidget.edit_labels">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget.edit_labels">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the dialog to edit the text labels in the plot.&quot;&quot;&quot;</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">LabelDialog</span><span class="o">.</span><span class="n">update_project</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;figtitle&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;clabel&quot;</span><span class="p">,</span> <span class="s2">&quot;xlabel&quot;</span><span class="p">,</span> <span class="s2">&quot;ylabel&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Plot2DWidget.transform">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget.transform">[docs]</a>
    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reimplemented to not transform the coordinates.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>


<div class="viewcode-block" id="Plot2DWidget.refresh_from_sp">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.Plot2DWidget.refresh_from_sp">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_from_sp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh this widget from the plotters project.&quot;&quot;&quot;</span>
        <span class="n">plotter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotter</span>
        <span class="k">if</span> <span class="n">plotter</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">btn_cmap</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="LinePlotWidget">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget">[docs]</a>
<span class="k">class</span> <span class="nc">LinePlotWidget</span><span class="p">(</span><span class="n">PlotMethodWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget to control the lineplot plotmethod.&quot;&quot;&quot;</span>

    <span class="n">plotmethod</span> <span class="o">=</span> <span class="s2">&quot;lineplot&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fmt_setup_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_dimension_combo</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_line_selection</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_labels_button</span><span class="p">,</span>
        <span class="p">]</span>

<div class="viewcode-block" id="LinePlotWidget.get_rows">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.get_rows">[docs]</a>
    <span class="k">def</span> <span class="nf">get_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">GridCell</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the rows of the formatoption widgets.</span>

<span class="sd">        This method should take callable from the :attr:`fmt_setup_functions`</span>
<span class="sd">        list and return the rows corresponding to :attr:`formatoption_rows`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_dimension_combo</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;x-Dimension:&quot;</span><span class="p">)),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_line_selection</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Active line:&quot;</span><span class="p">)),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="p">),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_add</span><span class="p">),</span>
                <span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_del</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">func</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_labels_button</span><span class="p">:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">GridCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span><span class="p">,</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">4</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown function </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">row</span><span class="p">]</span></div>


<div class="viewcode-block" id="LinePlotWidget.setup_dimension_combo">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.setup_dimension_combo">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_dimension_combo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the combobox for selecting the x-dimension.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trigger_reset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="LinePlotWidget.setup_line_selection">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.setup_line_selection">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_line_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup the row for selecting new lines.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trigger_refresh</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_add</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">get_psy_icon</span><span class="p">(</span><span class="s2">&quot;plus&quot;</span><span class="p">)),</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(),</span>
            <span class="s2">&quot;Add a line to the plot&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_del</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">get_psy_icon</span><span class="p">(</span><span class="s2">&quot;minus&quot;</span><span class="p">)),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_line</span><span class="p">,</span>
            <span class="s2">&quot;Add a line to the plot&quot;</span><span class="p">,</span>
            <span class="n">icon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="LinePlotWidget.setup_labels_button">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.setup_labels_button">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_labels_button</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a button to modify the text labels.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">add_pushbutton</span><span class="p">(</span>
            <span class="s2">&quot;Edit labels&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_labels</span><span class="p">,</span>
            <span class="s2">&quot;Edit title, x-label, legendlabels, etc.&quot;</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xdim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the x-dimension for the plot.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

    <span class="nd">@xdim</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">xdim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xdim</span><span class="p">:</span> <span class="n">Hashable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xdim</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">currentText</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xdim</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The first array in the list.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()]</span>

<div class="viewcode-block" id="LinePlotWidget.add_line">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.add_line">[docs]</a>
    <span class="k">def</span> <span class="nf">add_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Hashable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">sl</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a line to the plot.</span>

<span class="sd">        This method adds a new line for the plot specified by the given</span>
<span class="sd">        `name` of the variable and the slices.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name: str</span>
<span class="sd">            The variable name to display</span>
<span class="sd">        ``**sl``</span>
<span class="sd">            The slices to turn the `name` variable into a 1D-array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No plot has yet been initialized!&quot;</span><span class="p">)</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">base</span>
        <span class="n">xdim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xdim</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;New line&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Select a variable&quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">xdim</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ok</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">psy</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">idims</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">sl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dim</span> <span class="o">!=</span> <span class="n">xdim</span><span class="p">:</span>
                <span class="n">sl</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="p">[</span><span class="n">sl</span><span class="p">],</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_texts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">replot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_refresh</span><span class="p">()</span></div>


<div class="viewcode-block" id="LinePlotWidget.remove_line">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.remove_line">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_line</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the current line from the plot.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No plot has yet been initialized, so I cannot remove any line!&quot;</span>
            <span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">replot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_texts</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotmethod</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">item_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the labels for the individual lines.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">_short_info</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">]</span>

<div class="viewcode-block" id="LinePlotWidget.init_dims">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.init_dims">[docs]</a>
    <span class="k">def</span> <span class="nf">init_dims</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">DataArray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the formatoptions for a new plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        var: xarray.Variable</span>
<span class="sd">            The variable in the base dataset</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A mapping from formatoption or dimension to the corresponding value</span>
<span class="sd">            for the plotmethod.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">xdim</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xdim</span> <span class="ow">or</span> <span class="nb">next</span><span class="p">(</span>
            <span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span> <span class="kc">None</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="p">:</span>
            <span class="n">arr_names</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">arrname</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">arrname</span> <span class="o">!=</span> <span class="s2">&quot;attrs&quot;</span><span class="p">:</span>
                    <span class="n">dims</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;dims&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">xdim</span> <span class="ow">in</span> <span class="n">dims</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">sl</span> <span class="ow">in</span> <span class="n">dims</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                                <span class="n">dims</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">dims</span><span class="p">[</span><span class="n">xdim</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">dims</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="n">arr_names</span><span class="p">[</span><span class="n">arrname</span><span class="p">]</span> <span class="o">=</span> <span class="n">dims</span>
            <span class="n">ret</span><span class="p">[</span><span class="s2">&quot;arr_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr_names</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xdim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="n">xdim</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span> <span class="k">if</span> <span class="n">var</span><span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xdim</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot plot variable </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> with size smaller than &quot;</span>
                    <span class="s2">&quot;2&quot;</span>
                <span class="p">)</span>
            <span class="n">ret</span><span class="p">[</span><span class="n">xdim</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">!=</span> <span class="n">xdim</span><span class="p">:</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="LinePlotWidget.edit_labels">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.edit_labels">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the dialog to edit the text labels in the plot.&quot;&quot;&quot;</span>
        <span class="n">dialogs</span><span class="o">.</span><span class="n">LabelDialog</span><span class="o">.</span><span class="n">update_project</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;figtitle&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;xlabel&quot;</span><span class="p">,</span> <span class="s2">&quot;ylabel&quot;</span><span class="p">,</span> <span class="s2">&quot;legendlabels&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="LinePlotWidget.block_combos">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.block_combos">[docs]</a>
    <span class="nd">@contextlib</span><span class="o">.</span><span class="n">contextmanager</span>
    <span class="k">def</span> <span class="nf">block_combos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Temporarilly block any signal of the combo boxes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">yield</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="LinePlotWidget.valid_variables">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.valid_variables">[docs]</a>
    <span class="k">def</span> <span class="nf">valid_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Hashable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of variables that can be visualized with this plotmethod.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ds: xarray.Dataset</span>
<span class="sd">            The dataset to use</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of str</span>
<span class="sd">            List of variable names to plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">valid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid</span> <span class="k">if</span> <span class="n">current_dim</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">]</span></div>


<div class="viewcode-block" id="LinePlotWidget.setEnabled">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.setEnabled">[docs]</a>
    <span class="k">def</span> <span class="nf">setEnabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enable or disable the datagrid and color buttons.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b: bool</span>
<span class="sd">            If True, enable the buttons, else disable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_add</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_del</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_labels</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="LinePlotWidget.refresh">
<a class="viewcode-back" href="../../api/psy_view.plotmethods.html#psy_view.plotmethods.LinePlotWidget.refresh">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh this widget from the given dataset.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_combos</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">all_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">psy</span><span class="o">.</span><span class="n">iter_base_variables</span>
                        <span class="p">]</span>
                        <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">intersection</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">dims</span> <span class="ow">in</span> <span class="n">all_dims</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                    <span class="n">intersection</span><span class="o">.</span><span class="n">intersection_update</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>
                <span class="n">new_dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">filter</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">intersection</span><span class="p">,</span>
                        <span class="n">unique_everseen</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">all_dims</span><span class="p">)),</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">new_dims</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span>
                    <span class="n">new_dims</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">)</span>

                <span class="c1"># fill lines combo</span>
                <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_texts</span>
                <span class="n">short_descs</span> <span class="o">=</span> <span class="p">[</span><span class="n">textwrap</span><span class="o">.</span><span class="n">shorten</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">descriptions</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">short_descs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">desc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">descriptions</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setItemData</span><span class="p">(</span>
                        <span class="n">i</span><span class="p">,</span> <span class="n">desc</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ToolTipRole</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">descriptions</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">short_descs</span><span class="p">[</span><span class="n">current</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_combos</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_dims</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo_lines</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
</div>

</pre></div>

           </div>
          </div>
          <!--
SPDX-FileCopyrightText: 2021-2024 Helmholtz-Zentrum hereon GmbH

SPDX-License-Identifier: CC-BY-4.0
-->

<footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024 Helmholtz-Zentrum hereon GmbH.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  

<div class="footer">
    <span class="creativecommons">
    <a href="https://creativecommons.org/licenses/by/4.0/" >
    <img style="height: 1.5em;" src="../../_static/license_logo.png" border="0" alt="Creative Commons License"/>
    </a>
    This documentation is licensed under
    <a href="https://creativecommons.org/licenses/by/4.0/">
    CC-BY-4.0
    </a>
    </span>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>